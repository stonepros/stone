tasks:
- install:
    branch: octopus
- print: "**** done install task..."
- print: "**** done start installing octopus stoneadm ..."
- stoneadm:
    image: quay.stone.io/stone-ci/stone:octopus
    stoneadm_branch: octopus
    stoneadm_git_url: https://github.com/stonepros/stone
    conf:
      osd:
        #set config option for which cls modules are allowed to be loaded / used
        osd_class_load_list: "*"
        osd_class_default_list: "*"
    # deploy additional mons the "old" (octopus) way
    add_mons_via_daemon_add: true
    avoid_pacific_features: true
- print: "**** done end installing octopus stoneadm ..."

- stoneadm.shell:
    mon.a:
      - stone fs volume create foo
- stone.healthy:

- print: "**** done creating new fs"

- stoneadm.shell:
    mon.a:
      - stone config set mgr mgr/stoneadm/use_repo_digest true --force
      - stone config set mon mon_warn_on_insecure_global_id_reclaim false --force
      - stone config set mon mon_warn_on_insecure_global_id_reclaim_allowed false --force

- print: "**** done stoneadm.shell stone config set mgr..."

- print: "**** done start parallel"
- parallel:
    - workload
    - upgrade-sequence
- print: "**** done end parallel"
